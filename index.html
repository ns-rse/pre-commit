<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.14">

  <meta name="author" content="Neil Shephard">
  <title>pre-commit - Pre-commit : Protecting your future self</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Pre-commit : Protecting your future self</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Neil Shephard 
</div>
</div>
</div>

</section>
<section id="view-these-slides" class="slide level2">
<h2>View these slides…</h2>

<img data-src="assets/img/slides.png" class="r-stretch"><p><a href="https://ns-rse.github.io/pre-commit/#/title-slide"><strong>ns-rse.github.io/pre-commit/</strong></a></p>
<aside class="notes">
<p>You can scan this QR code and it will take you to these slides or you can visit the site they are hosted at by going to ns-rse.github.io/pre-commit/</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li>Research Software Engineer at University of Sheffield</li>
<li>Background : Statistical Genetics, Medical Statistics and Data Scientist for Telematics Company</li>
<li>Blog Post (2022-10-10) : <a href="https://rse.shef.ac.uk/blog/pre-commit/">pre-commit : Protecting your future self</a></li>
</ul>

<img data-src="assets/img/pre-commit-blog-qr.png" class="r-stretch"><aside class="notes">
<p>Good morning/afternoon, my name is Neil Shephard and I’m a Research Software Engineer at the University of Sheffield.</p>
<p>I was invited here today by Alex Coleman, thank you Alex, on the back of a blog post I wrote pre-commit : Protecting your Future Self and the QR code will take you to the blog post if you’re quick enough to scan it before I move on.</p>
<p>A very brief overview of my background and experience as I’ve only worked as a Research Software Engineer for a little under a year and matured into this role after a convoluted career pathway via Statistical Genetics, Medical Statistics during which I developed a keen interest in reproducible research and started using Git.</p>
<p>Prior to starting in my current role I spent a few years as a Data Scientist at a telematics company where I didn’t really do much data science but did learn Python, working collaboratively with Git and good practices for software development and engineering.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="structure" class="slide level2">
<h2>Structure</h2>
<ul>
<li>(Very) brief Git version control.</li>
<li>A digression into Linting and Testing.</li>
<li>Git Hooks.</li>
<li><code>pre-commit</code> installation.</li>
<li><code>pre-commit</code> configuration.</li>
<li><code>pre-commit</code> usage.</li>
<li><code>pre-commit</code> in CI/CD.</li>
</ul>
<aside class="notes">
<p>In this talk I’ll give a very brief overview of using Git for version control before making a digression into linting and testing. We’ll then look at Git Hooks because they underpin the functionality of <code>pre-commit</code> and I’ll then go through installing and configuring pre-commit, hopefully give a demonstration that won’t fail and then show how <code>pre-commit</code> can be integrated into Continuous Integration and Delivery pipelines.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="git" class="slide level2">
<h2>Git</h2>

<img data-src="https://imgs.xkcd.com/comics/git.png" class="r-stretch quarto-figure-center"><p class="caption">xkcd (1597)</p><p><a href="https://xkcd.com/1597/">https://xkcd.com/1597/</a></p>
<aside class="notes">
<p>Ok, Git is pretty popular but could I have a show of hands for how many people are familiar with and use Git on a daily basis please?</p>
<p><strong>Pause</strong></p>
<p>Great, looks like most of the audience are familiar with Git and hopefully are a little more proficient than the XKCD protagonists.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="git-workflow" class="slide level2">
<h2>Git Workflow</h2>
<!-- https://mermaid.live/edit#pako:eNqlkjFrwzAQhf-KODBaTKg9amwLXbJ11XK2L7KIJQVZSinG_72SaAJpnFKoJvHufe8dSAv0biAQUFWLtjoItjA-ObWnM01cMD5QFxWvGQ8jGcpKhzNlQenw5vE0Jm3h8-g-nj3afqQ5CcFHqov44ozRYY9dicv6urK1qqS98NKydPriu793JZQdCEP01HwbRuqPLgZmUNsN_jL-QT2o2Ei7bW23Y9s_xv6yxX2zIa_oirCASjAJ56dds2sk_G-RBy3tTUt7bSkRUEMyJ3JIn2TJEwnlK0jIyID-mIE1-TAG9_5pexDl-SGeBgz0qlF5NCAOOM20fgEbjs0N -->
<div class="cell" data-reveal="true" data-fig-height="2">
<div class="cell-output-display">
<div>
<p>
</p><pre class="mermaid mermaid-js" data-tooltip-selector="#mermaid-tooltip-1">%%{init: { 'logLevel': 'debug', 'theme': 'base', 'gitGraph': {'showBranches': true,'showCommitLabel': true, 'rotateCommitLabel': true}} }%%
gitGraph
    commit
    commit
    branch feature1
    checkout main
    commit
    checkout feature1
    commit
    commit
    checkout main
    branch feature2
    checkout feature2
    commit
    commit
    checkout feature1
    commit
    checkout main
    merge feature1 tag: "v0.1.1"
    checkout feature2
    commit
    commit
    checkout main
    merge feature2 tag: "v0.1.2"
    commit
</pre>
<div id="mermaid-tooltip-1" class="mermaidTooltip">

</div>
<p></p>
</div>
</div>
</div>
<aside class="notes">
<p>A typical workflow of a version controlled directory is shown here</p>
<ul>
<li>Make a branch from <code>main</code> to add a <code>feature</code> and here we have two features being developed.</li>
<li>Edit some files on each branch</li>
<li>Staging and <strong>commit</strong> changes as you go, then when ready you.</li>
<li>Push the changes to the remote <code>origin</code> such as GitHub or GitLab</li>
<li>Make a pull request to merge these changes into the <code>main</code> branch.</li>
<li>If you’re lucky you won’t have any merge conflicts. and once approved</li>
<li>Once approved and merged another commit is made marking the inclusion of the changes and a tag can optionally be applied.</li>
</ul>
<p>That gives got an overview of the Git development cycle and how commits fit in we’ll move on to linting and testing.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linting-and-testing" class="slide level2">
<h2>Linting and Testing</h2>
<p>A digression…</p>
<ul>
<li>Good practice to lint code &amp; conform to Style Guides</li>
<li>Good practice to have tests in place for code.</li>
</ul>

<img data-src="assets/img/linting.png" class="r-stretch"><p><a href="https://rse.shef.ac.uk/blog/2022-04-19-linting/">https://rse.shef.ac.uk/blog/2022-04-19-linting/</a> (<a href="https://rse.shef.ac.uk/blog/2022-04-19-linting/">Linting - What is all the fluff about?</a>)</p>
<aside class="notes">
<p>When writing code and it is good practice to lint your code to ensure it conforms to the languages style guides. These are useful because if code is written in a consistent style it makes it easier for multiple people, including your future self to read and understand.</p>
<p>Similarly it is sensible, and some would argue essential, to write tests to ensure that your functions, methods and sclasses work as expected. These tests are run regularly against your code base as it is developed to ensure that changes made to the code don’t break.</p>
<p>Often these will be run as you write your code and as part of the Continuous Integration pipelines.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-simple-function" class="slide level2">
<h2>A simple <span class="emoji" data-emoji="snake">🐍</span> function</h2>
<p><a href="assets/python/sample.py"><code>sample.py</code></a></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">def</span> find_files(file_path: Union[<span class="bu">str</span>, Path], file_ext: <span class="bu">str</span>) <span class="op">-&gt;</span> List:</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="co">"""Recursively find files of the stated type along the given file path."""</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="co"># We have a really long comment on this line just for demonstration purposes so that we can generate a few errors that need linting</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="cf">try</span>:</span>
<span id="cb1-9"><a href="#cb1-9"></a>        <span class="cf">return</span> <span class="bu">list</span>(Path(file_path).rglob(<span class="ss">f"**</span><span class="sc">{</span>file_ext<span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="cf">except</span>:</span>
<span id="cb1-11"><a href="#cb1-11"></a>        <span class="cf">raise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>This is a simple function in Python that we’ll use to demonstrate linting and tests. You don’t need to be too familiar with Python to understand and follow along but a quick explanation is that a few libraries are imported, then the function find_files is defined, it takes two arguments a file path and a file extension and it will recursively find all files ending with the given extension along that path, and if an exception is encountered it is raised.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="a-simple-test" class="slide level2">
<h2>A Simple Test</h2>
<p><a href="assets/python/test_sample.py"><code>test_sample.py</code></a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">from</span> .sample <span class="im">import</span> find_files</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">def</span> test_find_files():</span>
<span id="cb2-4"><a href="#cb2-4"></a>    <span class="co">"""Test the find_files() function"""</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>    py_files <span class="op">=</span> find_files(file_path<span class="op">=</span><span class="st">"./"</span>, file_ext<span class="op">=</span><span class="st">".py"</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="cf">assert</span> <span class="bu">isinstance</span>(py_files, <span class="bu">list</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>    <span class="cf">assert</span> <span class="st">"sample.py"</span> <span class="kw">in</span> py_files</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>This is an example of a test that you might write to check the <code>find_files</code> function.</p>
<p>It imports the function and uses it to look in the current directory for files with the extension <code>.py</code> saving the results to <code>py_files</code>. The type of this is checked and it should be a list and then a check is made for the presence of the file <code>sample.py</code> in that list is made.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linting-and-testing-tools" class="slide level2">
<h2>Linting and Testing Tools</h2>
<ul>
<li><a href="https://github.com/psf/black">black</a> <a href="https://pep8.org/">PEP8</a> compliance.</li>
<li><a href="https://flake8.pycqa.org/en/latest/">flake8</a> <a href="https://pep8.org/">PEP8</a> compliance.</li>
<li><a href="https://pylint.pycqa.org/en/latest/index.html">pylint</a> <a href="https://pep8.org/">PEP8</a> compliance, code smells and refactoring suggestions.</li>
<li><a href="https://docs.pytest.org/en/7.2.x/">pytest</a></li>
</ul>
<aside class="notes">
<p>We’ve got some sample code but it might not meet the style guides.</p>
<p>Style guides set out a consistent way to write and structure code and there are guides for different languages and sometimes even different styles within a language.</p>
<p>For Python there is the PEP8 style guide and there are a number of tools that help with linting Python code to be compliant with PEP8 such as <code>black</code> which mostly applies formatting, <code>flake8</code> and <code>pylint</code> which check formatting and also look for code smells where poor design patterns have been used and make refactoring suggestions.</p>
<p>Then there is the <code>pytest</code> framework for writing and running tests which I can highly recommend along with many of its extensions.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linting-and-testing-manually" class="slide level2">
<h2>Linting and Testing manually…</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">black</span> sample.py</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="ex">flake8</span> sample.py</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="ex">pylint</span> sample.py</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="ex">pytest</span> test_sample.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>(<a href="https://rse.shef.ac.uk/blog/git-blame/">Who’s to Blame?</a>)</p>
<aside class="notes">
<p>If you were running linting manually then you would have to invoke each and run them against a specific file or directory.</p>
<p>Running black against your code base could actually cause problems as it will reformat files in place using its opinionated style. You would then have to commit those changes and the blame would be associated with code that you only formatted rather than wrote. There are ways around this using Git’s <code>--ignore-rev</code> flag to store commits in a file <code>.git-blame-ignore-revs</code> that lists the hashes for which blame is to be ignored (see <a href="https://akrabat.com/ignoring-revisions-with-git-blame/">article</a>)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="linting-manually" class="slide level2 scrollable">
<h2>Linting manually</h2>
<p><code>black</code></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="ex">❱</span> black sample.py</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="ex">All</span> done! ✨ 🍰 ✨</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="ex">1</span> file changed.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>flake8</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="ex">❱</span> flake8 sample.py</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="ex">sample.py:1:1:</span> D100 Missing docstring in public module</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="ex">sample.py:1:1:</span> F401 <span class="st">'numpy as np'</span> imported but unused</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="ex">sample.py:2:1:</span> F401 <span class="st">'pandas as pd'</span> imported but unused</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="ex">sample.py:7:36:</span> F821 undefined name <span class="st">'Union'</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="ex">sample.py:7:73:</span> F821 undefined name <span class="st">'List'</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="ex">sample.py:8:80:</span> E501 line too long <span class="er">(</span><span class="ex">87</span> <span class="op">&gt;</span> 79 characters<span class="kw">)</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="ex">sample.py:9:80:</span> E501 line too long <span class="er">(</span><span class="ex">135</span> <span class="op">&gt;</span> 79 characters<span class="kw">)</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="ex">sample.py:12:5:</span> E722 do not use bare <span class="st">'except'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>pylint</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="ex">❱</span> pylint sample.py</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="ex">*************</span> Module sample</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="ex">sample.py:9:0:</span> C0301: Line too long <span class="er">(</span><span class="ex">135/120</span><span class="kw">)</span> <span class="kw">(</span><span class="ex">line-too-long</span><span class="kw">)</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="ex">sample.py:1:0:</span> C0114: Missing module docstring <span class="er">(</span><span class="ex">missing-module-docstring</span><span class="kw">)</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="ex">sample.py:7:35:</span> E0602: Undefined variable <span class="st">'Union'</span> <span class="er">(</span><span class="ex">undefined-variable</span><span class="kw">)</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="ex">sample.py:7:72:</span> E0602: Undefined variable <span class="st">'List'</span> <span class="er">(</span><span class="ex">undefined-variable</span><span class="kw">)</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="ex">sample.py:12:4:</span> W0706: The except handler raises immediately <span class="er">(</span><span class="ex">try-except-raise</span><span class="kw">)</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="ex">sample.py:4:0:</span> C0411: standard import <span class="st">"from pathlib import Path"</span> should be placed before <span class="st">"import numpy as np"</span> <span class="er">(</span><span class="ex">wrong-import-order</span><span class="kw">)</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="ex">sample.py:1:0:</span> W0611: Unused numpy imported as np <span class="er">(</span><span class="ex">unused-import</span><span class="kw">)</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="ex">sample.py:2:0:</span> W0611: Unused pandas imported as pd <span class="er">(</span><span class="ex">unused-import</span><span class="kw">)</span></span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="ex">-------------------------------------</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="ex">Your</span> code has been rated at <span class="at">-10.00</span>/10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>pytest</code></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex">❱</span> pylint test_sample.py</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="ex">=================</span> test session starts =================</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="ex">platform</span> linux <span class="at">--</span> Python 3.7.11, pytest-7.1.1, pluggy-1.0.0</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="ex">rootdir:</span> /home/neil/work/projects/pre-commit/assets/python</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="ex">plugins:</span> hydra-core-1.2.0, regtest-1.5.0, cov-3.0.0</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="ex">collected</span> 0 items / 1 error</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="ex">=======================</span> ERRORS ========================</span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="ex">___________</span> ERROR collecting test_sample.py ___________</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="ex">test_sample.py:1:</span> in <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="ex">from</span> .sample import find_files</span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="ex">sample.py:7:</span> in <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="ex">def</span> find_and_load_files<span class="er">(</span><span class="ex">file_path:</span> Union[str, Path], file_type: str<span class="kw">)</span><span class="bu">:</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="ex">E</span>   NameError: name <span class="st">'Union'</span> is not defined</span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="ex">================</span> short test summary info ===============</span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="ex">ERROR</span> test_sample.py <span class="at">-</span> NameError: name <span class="st">'Union'</span> is not defined</span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="ex">!!!!!!!!</span> Interrupted: 1 error during collection !!!!!!!!</span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="ex">===================</span> 1 error in 0.49s ===================</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<aside class="notes">
<p>Running each of these manually is four separate commands. This takes you the developer time to switch to a terminal, make sure your virtual environment is activated and your in the same directory as your work, then run the commands.</p>
<p>Black finds and corrects some errors.</p>
<p>Flake8 complains about some problems with the style of the code as does and we get a very poor score of -10.</p>
<p>Pytest won’t even run because of errors so we can’t check our code.</p>
<p>You then correct any errors and repeat the cycle, albeit a little quicker and all of this before you can commit your changes to git….</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<section id="then-you-can-commit-and-push" class="slide level2">
<h2>…<em>then</em> you can commit and push</h2>

<img data-src="assets/img/gitsave_fire.png" width="200" class="r-stretch"><aside class="notes">
<p>Git work cycles encourages regular saving of work, by staging and committing work into Git. Periodically you should Git push to ensure your work is backed up just in case of fires or your hard drive failing.</p>
<p>But the process of repeatedly linting and testing your code quickly becomes tedious and you may even forget to do so before making commits. This means there is potential for errors to creep into the code base if these steps aren’t undertaken.</p>
<p>What can we do to mitigate this?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="automate-with-pre-commit" class="slide level2">
<h2>Automate with <a href="https://pre-commit.com">pre-commit</a></h2>
<ul>
<li>Uses <a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Git Hooks</a> to run checks automatically.</li>
<li>Written in Python but hooks for most languages.</li>
<li>Large number of <a href="https://pre-commit.com/hooks.html">supported hooks</a> available to use.</li>
</ul>
<aside class="notes">
<p>This is where <code>pre-commit</code> comes in handy. It uses Git Hooks to run checks automatically.</p>
<p>It’s written in Python but you don’t need to know or use Python yourself to use <code>pre-commit</code> as there are a large number of existing <code>pre-commit</code> hooks that are available to be used off the shelf.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="what-are-hooks" class="slide level2">
<h2>What are Hooks?</h2>
<ul>
<li>Actions that are run prior to or in response to a given action.</li>
</ul>
<div class="sourceCode" id="cb8" data-code-line-numbers="9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="ex">❱</span> ls <span class="at">-lha</span> .git/hooks</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="ex">drwxr-xr-x</span> neil neil 4.0 KB Mon Oct 24 10:26:37 2022  .</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="ex">drwxr-xr-x</span> neil neil 4.0 KB Tue Jan  3 18:48:37 2023  ..</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="ex">.rwxr-xr-x</span> neil neil 478 B  Sun Aug 14 13:35:27 2022  applypatch-msg.sample</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="ex">.rwxr-xr-x</span> neil neil 896 B  Sun Aug 14 13:35:27 2022  commit-msg.sample</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="ex">.rwxr-xr-x</span> neil neil 4.6 KB Sun Aug 14 13:35:27 2022  fsmonitor-watchman.sample</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="ex">.rwxr-xr-x</span> neil neil 189 B  Sun Aug 14 13:35:27 2022  post-update.sample</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="ex">.rwxr-xr-x</span> neil neil 424 B  Sun Aug 14 13:35:27 2022  pre-applypatch.sample</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="ex">.rwxr-xr-x</span> neil neil 1.6 KB Sun Aug 14 13:35:27 2022  pre-commit.sample</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="ex">.rwxr-xr-x</span> neil neil 416 B  Sun Aug 14 13:35:27 2022  pre-merge-commit.sample</span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="ex">.rwxr-xr-x</span> neil neil 1.3 KB Sun Aug 14 13:35:27 2022  pre-push.sample</span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="ex">.rwxr-xr-x</span> neil neil 4.8 KB Sun Aug 14 13:35:27 2022  pre-rebase.sample</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="ex">.rwxr-xr-x</span> neil neil 544 B  Sun Aug 14 13:35:27 2022  pre-receive.sample</span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="ex">.rwxr-xr-x</span> neil neil 1.5 KB Sun Aug 14 13:35:27 2022  prepare-commit-msg.sample</span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="ex">.rwxr-xr-x</span> neil neil 2.7 KB Sun Aug 14 13:35:27 2022  push-to-checkout.sample</span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="ex">.rwxr-xr-x</span> neil neil 3.6 KB Sun Aug 14 13:35:27 2022  update.sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>Hooks are actions that are run prior to or in response to a given action.</p>
<p>When you initialise a Git repository locally a number of example run hooks that are disabled by default but could be run in response to different actions or steps in the git work cycle and these can be found under <code>.git/hooks/</code> if you’ve cloned a repository then these <code>.git</code> directory generally isn’t included so you won’t have these.</p>
<p>This is a directory listing and you can see there are a number of different stages at which hooks might apply, but as the name of this talk gives away, the key hook of interest here is the <code>pre-commit</code> hook.</p>
<p>These are Bash scripts and you could sit down and craft your own script to undertake all the tasks you wish to run prior to making commits. The <code>pre-commit</code> tool and its array of hooks takes away the need to do this and saves you a lot of time as all you need to do is configure the hooks you wish to run.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="installation-of-pre-commit" class="slide level2">
<h2>Installation of pre-commit</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Python</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="ex">❱</span> workon a_virtual_env  <span class="co"># Optional</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="ex">❱</span> pip install pre-commit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Conda Environment</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="ex">❱</span> conda activate conda_env</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="ex">❱</span> conda install <span class="at">-c</span> <span class="dt">\</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>        conda-forge pre-commit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<p><strong>GNU/Linux</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Arch</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="ex">❱</span> pacman <span class="at">-Syu</span> python-pre-commit</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># Gentoo</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="ex">❱</span> emerge <span class="at">-av</span> pre-commit</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># Debian/Ubuntu</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="ex">❱</span> sudo apt install pre-commit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>OSX</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1"></a><span class="ex">❱</span> brew install pre-commit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<aside class="notes">
<p>I mentioned earlier that you didn’t really need to know or use Python which was mostly true but you do need to install <code>pre-commit</code> this can be done using <code>pip</code> the Python tool for installing Python packages from the Python Package Index and you can optionally do this within a virtual environment or within a Conda Environment.</p>
<p>If you use GNU/Linux then many package managers have pre-commit available in the package repositories to install and some examples of how to install the relevant packages under Arch, Gentoo and Ubuntu are shown.</p>
<p>The OSX package manager homebrew also includes pre-commit so you can <code>brew install</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pre-commit-config.yaml" class="slide level2 scrollable">
<h2><code>.pre-commit-config.yaml</code></h2>
<p>Root of a project under Git version control.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">repos</span><span class="kw">:</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/pre-commit/pre-commit-hooks</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> v4.3.0</span><span class="co">  # Use the ref you want to point at</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> trailing-whitespace</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="at">        </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">file</span><span class="kw">,</span><span class="at"> text</span><span class="kw">]</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> end-of-file-fixer</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="at">        </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">file</span><span class="kw">,</span><span class="at"> text</span><span class="kw">]</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-docstring-first</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-case-conflict</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> requirements-txt-fixer</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-byte-order-marker</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-yaml</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/psf/black</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> </span><span class="fl">22.10.0</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> black</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="at">        </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">python</span><span class="kw">]</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="at">        </span><span class="fu">additional_dependencies</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">'click==8.0.4'</span><span class="kw">]</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="at">        </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"--extend-exclude"</span><span class="kw">,</span><span class="at"> </span><span class="st">"plotting.py"</span><span class="kw">]</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/pycqa/flake8.git</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> </span><span class="fl">5.0.4</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> flake8</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="at">        </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"--extend-exclude"</span><span class="kw">,</span><span class="at"> </span><span class="st">"_version.py"</span><span class="kw">]</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="at">        </span><span class="fu">additional_dependencies</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">flake8-print</span><span class="kw">]</span></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="at">        </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">python</span><span class="kw">]</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> local</span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb13-30"><a href="#cb13-30"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> pylint</span></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="at">        </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"--rcfile=.pylintrc"</span><span class="kw">]</span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Pylint</span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="at">        </span><span class="fu">entry</span><span class="kw">:</span><span class="at"> python -m pylint</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="at">        </span><span class="fu">language</span><span class="kw">:</span><span class="at"> system</span></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="at">        </span><span class="fu">files</span><span class="kw">:</span><span class="at"> \.py$</span></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> local</span></span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> pytest</span></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> pytest</span></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="at">        </span><span class="fu">entry</span><span class="kw">:</span><span class="at"> pytest --cov</span></span>
<span id="cb13-41"><a href="#cb13-41"></a><span class="at">        language:system</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<aside class="notes">
<p>Configuration of pre-commit is via a YAML file called <code>.pre-commit-config.yaml</code> and this should reside in the root of a project that is under Git version control.</p>
<p>The top-level defines <code>repos:</code> and you then enable and configure each of the <code>pre-commit</code> hooks you wish to use for your repository under its own <code>- repo</code> section. This example is configured to run some of the main <code>pre-commit-hooks</code> as well as the <code>black</code>, <code>flake8</code> and two <code>local</code> hooks that run <code>pylint</code> and <code>pytest</code>.</p>
<p>Lets take a look at how a <code>pre-commit</code> hook is configured by focusing on the <code>black</code> checker.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<section id="hook-configuration" class="slide level2 scrollable">
<h2>Hook configuration</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/psf/black</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> </span><span class="fl">22.10.0</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> black</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="at">        </span><span class="fu">types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">python</span><span class="kw">]</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="at">        </span><span class="fu">additional_dependencies</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">'click==8.0.4'</span><span class="kw">]</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="at">        </span><span class="fu">args</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="st">"--extend-exclude"</span><span class="kw">,</span><span class="at"> </span><span class="st">"plotting.py"</span><span class="kw">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<aside class="notes">
<p><code>pre-commit</code> hooks are typically hosted on GitHub (or other forge) and the <code>- repo:</code> field defines the URL from which a virtual environment will be downloaded and installed for running the hook. Each hook has a <code>rev</code>ision that the user can explicitly specify. Repositories than have one or more <code>hooks</code> which have a unique <code>id</code>’s in this case <code>black</code> which works with files of <code>types</code> python. An additional dependency on <code>click</code> is defined and this configuration has some additional arguments that are passed to black to extend the list of excluded files, in this case excluding the file <code>plotting.py</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<section id="local-hook-configuration" class="slide level2 scrollable">
<h2>Local Hook Configuration</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> local</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="at">      </span><span class="fu">-id</span><span class="kw">:</span><span class="at"> pytest</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> pytest</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="at">      </span><span class="fu">entry</span><span class="kw">:</span><span class="at"> pytest --cov</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="at">      </span><span class="fu">language</span><span class="kw">:</span><span class="at"> system</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<aside class="notes">
<p>Both the <code>pylint</code> and <code>pytest</code> hooks are configured differently, the <code>repo</code> here is local, which means that rather than downloading a virtual environment to run the hook its going to use your existing local environment. This is because the environments that are available online do not include the packages that need to be installed to lint and test the code and so instead <code>pre-commit</code> uses the <code>system</code> where it is being run, i.e.&nbsp;the virtual environment you have activated.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<section id="project-pre-commit-installation" class="slide level2">
<h2>Project pre-commit installation</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1"></a><span class="ex">❱</span> git add .pre-commit-config</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="ex">❱</span> pre-commit <span class="at">--version</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="ex">❱</span> pre-commit install</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="ex">pre-commit</span> installed at .git/hooks/pre-commit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>Now that <code>pre-commit</code> is installed on your system and a configuration file has been added to your repository you can install the <code>pre-commit</code> hook in the repository.</p>
<p>You add the configuration file to the repository, check that <code>pre-commit</code> is available using the <code>--version</code> flag and then install it.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="check-existing-files" class="slide level2 scrollable">
<h2>Check existing Files</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1"></a><span class="ex">❱</span> pre-commit run <span class="at">--all-files</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="ex">[INFO]</span> Initializing environment for https://github.com/pre-commit/pre-commit-hooks.</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="ex">[INFO]</span> Initializing environment for https://github.com/psf/black.</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="ex">[INFO]</span> Initializing environment for https://github.com/pycqa/flake8.git.</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="ex">[INFO]</span> Installing environment for https://github.com/pre-commit/pre-commit-hooks.</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="ex">[INFO]</span> Once installed this environment will be reused.</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="ex">[INFO]</span> This may take a few minutes...</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="ex">[INFO]</span> Installing environment for https://github.com/psf/black.</span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="ex">[INFO]</span> Once installed this environment will be reused.</span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="ex">[INFO]</span> This may take a few minutes...</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="ex">[INFO]</span> Installing environment for https://github.com/pycqa/flake8.git</span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="ex">[INFO]</span> Once installed this environment will be reused.</span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="ex">[INFO]</span> This may take a few minutes...</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="ex">Check</span> Yaml.....................................................Passed</span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="ex">Fix</span> End of Files...............................................Passed</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="ex">Trim</span> Trailing Whitespace.......................................Failed</span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="ex">-</span> hook id: trailing-whitespace</span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="ex">-</span> exit code: 1</span>
<span id="cb17-19"><a href="#cb17-19"></a></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="ex">Files</span> were modified by this hook. Additional output:</span>
<span id="cb17-21"><a href="#cb17-21"></a></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="ex">Fixing</span> sample.py</span>
<span id="cb17-23"><a href="#cb17-23"></a></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="ex">black..........................................................Failed</span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="ex">reformatted</span> sample.py</span>
<span id="cb17-26"><a href="#cb17-26"></a></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="ex">All</span> done! ✨ 🍰 ✨</span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="ex">1</span> file reformatted.</span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="ex">flake8.........................................................Failed</span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="ex">-</span> hook id: flake8</span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="ex">-</span> exit code: 1</span>
<span id="cb17-32"><a href="#cb17-32"></a></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="ex">sample.py:1:1:</span> D100 Missing docstring in public module</span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="ex">sample.py:1:1:</span> F401 <span class="st">'numpy as np'</span> imported but unused</span>
<span id="cb17-35"><a href="#cb17-35"></a><span class="ex">sample.py:2:1:</span> F401 <span class="st">'pandas as pd'</span> imported but unused</span>
<span id="cb17-36"><a href="#cb17-36"></a><span class="ex">sample.py:7:36:</span> F821 undefined name <span class="st">'Union'</span></span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="ex">sample.py:7:73:</span> F821 undefined name <span class="st">'List'</span></span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="ex">sample.py:8:80:</span> E501 line too long <span class="er">(</span><span class="ex">87</span> <span class="op">&gt;</span> 79 characters<span class="kw">)</span></span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="ex">sample.py:9:80:</span> E501 line too long <span class="er">(</span><span class="ex">135</span> <span class="op">&gt;</span> 79 characters<span class="kw">)</span></span>
<span id="cb17-40"><a href="#cb17-40"></a><span class="ex">sample.py:12:5:</span> E722 do not use bare <span class="st">'except'</span></span>
<span id="cb17-41"><a href="#cb17-41"></a></span>
<span id="cb17-42"><a href="#cb17-42"></a><span class="ex">pylint.........................................................Failed</span></span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="ex">-</span> hook id: pylint</span>
<span id="cb17-44"><a href="#cb17-44"></a><span class="ex">-</span> exit code: 1</span>
<span id="cb17-45"><a href="#cb17-45"></a></span>
<span id="cb17-46"><a href="#cb17-46"></a><span class="ex">*************</span> Module python.sample</span>
<span id="cb17-47"><a href="#cb17-47"></a><span class="ex">sample.py:9:0:</span> C0301: Line too long <span class="er">(</span><span class="ex">135/120</span><span class="kw">)</span> <span class="kw">(</span><span class="ex">line-too-long</span><span class="kw">)</span></span>
<span id="cb17-48"><a href="#cb17-48"></a><span class="ex">sample.py:1:0:</span> C0114: Missing module docstring <span class="er">(</span><span class="ex">missing-module-docstring</span><span class="kw">)</span></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="ex">sample.py:7:35:</span> E0602: Undefined variable <span class="st">'Union'</span> <span class="er">(</span><span class="ex">undefined-variable</span><span class="kw">)</span></span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="ex">sample.py:12:4:</span> W0706: The except handler raises immediately <span class="er">(</span><span class="ex">try-except-raise</span><span class="kw">)</span></span>
<span id="cb17-51"><a href="#cb17-51"></a><span class="ex">sample.py:1:0:</span> W0611: Unused numpy imported as np <span class="er">(</span><span class="ex">unused-import</span><span class="kw">)</span></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="ex">sample.py:2:0:</span> W0611: Unused pandas imported as pd <span class="er">(</span><span class="ex">unused-import</span><span class="kw">)</span></span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="ex">sample.py:4:0:</span> C0411: standard import <span class="st">"from pathlib import Path"</span> should be placed before <span class="st">"import numpy as np"</span> <span class="er">(</span><span class="ex">wrong-import-order</span><span class="kw">)</span></span>
<span id="cb17-54"><a href="#cb17-54"></a></span>
<span id="cb17-55"><a href="#cb17-55"></a><span class="ex">------------------------------------</span></span>
<span id="cb17-56"><a href="#cb17-56"></a><span class="ex">Your</span> code has been rated at <span class="at">-3.75</span>/10</span>
<span id="cb17-57"><a href="#cb17-57"></a><span class="ex">pytest.........................................................Failed</span></span>
<span id="cb17-58"><a href="#cb17-58"></a><span class="ex">=================</span> test session starts =================</span>
<span id="cb17-59"><a href="#cb17-59"></a><span class="ex">platform</span> linux <span class="at">--</span> Python 3.7.11, pytest-7.1.1, pluggy-1.0.0</span>
<span id="cb17-60"><a href="#cb17-60"></a><span class="ex">rootdir:</span> /home/neil/work/projects/pre-commit/assets/python</span>
<span id="cb17-61"><a href="#cb17-61"></a><span class="ex">plugins:</span> hydra-core-1.2.0, regtest-1.5.0, cov-3.0.0</span>
<span id="cb17-62"><a href="#cb17-62"></a><span class="ex">collected</span> 0 items / 1 error</span>
<span id="cb17-63"><a href="#cb17-63"></a></span>
<span id="cb17-64"><a href="#cb17-64"></a><span class="ex">=======================</span> ERRORS ========================</span>
<span id="cb17-65"><a href="#cb17-65"></a><span class="ex">___________</span> ERROR collecting test_sample.py ___________</span>
<span id="cb17-66"><a href="#cb17-66"></a><span class="ex">test_sample.py:1:</span> in <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb17-67"><a href="#cb17-67"></a>    <span class="ex">from</span> .sample import find_files</span>
<span id="cb17-68"><a href="#cb17-68"></a><span class="ex">sample.py:7:</span> in <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb17-69"><a href="#cb17-69"></a>    <span class="ex">def</span> find_and_load_files<span class="er">(</span><span class="ex">file_path:</span> Union[str, Path], file_type: str<span class="kw">)</span><span class="bu">:</span></span>
<span id="cb17-70"><a href="#cb17-70"></a><span class="ex">E</span>   NameError: name <span class="st">'Union'</span> is not defined</span>
<span id="cb17-71"><a href="#cb17-71"></a><span class="ex">================</span> short test summary info ===============</span>
<span id="cb17-72"><a href="#cb17-72"></a><span class="ex">ERROR</span> test_sample.py <span class="at">-</span> NameError: name <span class="st">'Union'</span> is not defined</span>
<span id="cb17-73"><a href="#cb17-73"></a><span class="ex">!!!!!!!!</span> Interrupted: 1 error during collection !!!!!!!!</span>
<span id="cb17-74"><a href="#cb17-74"></a><span class="ex">===================</span> 1 error in 0.49s ===================</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<aside class="notes">
<p>Normally <code>pre-commit</code> only runs against the files that have been changed in a given commit and so after installing it would be wise to run it against all files.</p>
<p>The first time you run <code>pre-commit</code> it downloads Python virtual environments for each of the configured hooks so it can take a little while to run as it does this but as the output shows these are reused in future so once setup the process will run a lot quicker on subsequent runs of <code>pre-commit</code>.</p>
<p>Here we see it failed the “Trim trailing-whitespace” check and the file was modified.</p>
<p>And as with the manual linting and tests we see the files were modified by <code>black</code>, failed <code>flake8</code> and <code>pylint</code> and because of these errors also failed <code>pytest</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<section id="correcting-errors" class="slide level2 scrollable">
<h2>Correcting Errors</h2>
<p><strong>Original</strong> <a href="assets/python/sample.py"><code>sample.py</code></a></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="kw">def</span> find_files(file_path: Union[<span class="bu">str</span>, Path], file_ext: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="co">"""Recursively find files of the stated type along the given file path."""</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>    <span class="co"># Short comment</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="cf">try</span>:</span>
<span id="cb18-9"><a href="#cb18-9"></a>        <span class="cf">return</span> <span class="bu">list</span>(Path(file_path).rglob(<span class="ss">f"**</span><span class="sc">{</span>file_ext<span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb18-10"><a href="#cb18-10"></a>    <span class="cf">except</span>:</span>
<span id="cb18-11"><a href="#cb18-11"></a>        <span class="cf">raise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Linted</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">"""Find files of a given type """</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="im">from</span> typing <span class="im">import</span> Union</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="kw">def</span> find_files(file_path: Union[<span class="bu">str</span>, Path], file_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">list</span>:</span>
<span id="cb19-7"><a href="#cb19-7"></a>    <span class="co">"""Recursively find files of the stated type along the given file path."""</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="cf">return</span> Path(file_path).rglob(<span class="ss">f"*</span><span class="sc">{</span>file_type<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<aside class="notes">
<p>Lets fix the linting errors. You can see the original code and the linted code where we’ve addressed the problems that <code>flake8</code> and <code>pylint</code> were reporting by removing unused libraries, importing the missing <code>Union</code> class, removing the long comment line and removing the blank <code>try: ... except:</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<section id="add-and-commit-changes" class="slide level2">
<h2>Add and commit changes</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">git</span> add sample.py test_sample.py</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"Linting sample.py."</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="ex">Check</span> Yaml.....................................................Passed</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="ex">Fix</span> End of Files...............................................Passed</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="ex">Trim</span> Trailing Whitespace.......................................Passed</span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="ex">black..........................................................Passed</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="ex">flake8.........................................................Passed</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="ex">pylint.........................................................Passed</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="ex">pytest.........................................................Passed</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="ex">[INFO]</span> Restored changes from /home/neil/.cache/pre-commit/patch1674045267-394193.</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="ex">[main</span> 05b1568] Linting sample.py</span>
<span id="cb20-12"><a href="#cb20-12"></a> <span class="ex">1</span> file changed, 2 insertions<span class="er">(</span><span class="ex">+</span><span class="kw">)</span><span class="ex">,</span> 2 deletions<span class="er">(</span><span class="ex">-</span><span class="kw">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>So now we add the files and commit them and because we have installed <code>pre-commit</code> it runs as a hook and the checks we configured are run against the files we are committing, in this case <code>sample.py</code>.</p>
<p>The tests pass and so the commit is made. The <code>[INFO]</code> line sometimes appears when you have unstaged changes that are not included in current commit.</p>
<p>This is much quicker and efficient than having to run <code>black</code>, <code>flake8</code>, <code>pylint</code> and <code>pytest</code> against the changed files manually, there is no cognitive overhead involved in thinking about what files to run against as there may be in larger changes. You might consider running linting and tests against the whole code base but this could be problematic if there are unlinted files and if its a large code base with lots of tests take a long time to run. With <code>pre-commit</code> the linting and tests run only against the files included in the commit and so are faster.</p>
<p>This all streamlines the process and frees up developer time.</p>
<p>But its contingent on people using the tools locally, what if you have a contributor who hasn’t set themselves up with <code>pre-commit</code> as described and they make a pull request to have their bug fix or feature included. Is there a way to apply these checks against their pull request before it is committed to the <code>master</code> or <code>main</code> branch?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="continuous-integrationdelivery-cicd" class="slide level2">
<h2>Continuous Integration/Delivery (CI/CD)</h2>
<ul>
<li>Runs hooks on GitHub/GitLab/Codeberg/etc. in response to specific tasks/actions.</li>
<li><a href="https://docs.github.com/en/actions">GitHub Actions</a> (see also <a href="https://github.com/marketplace?type=actions">Actions Marketplace</a>)</li>
<li><a href="https://docs.gitlab.com/ee/ci/pipelines/">GitLab Pipelines</a></li>
<li>Codeberg uses <a href="https://woodpecker-ci.org/">Woodpecker CI</a></li>
<li><a href="https://www.jenkins.io/">Jenkins</a></li>
</ul>
<aside class="notes">
<p>Fortunately there is because many projects use Continuous Integration.</p>
<p>This involves running checks on Pull Requests before merging changes into <code>main</code> and <code>master</code> and running various checks against them such as test suites or linting. Continuous delivery extends this and builds packages for release and tests that these work so they are ready to deploy.</p>
<p>GitHub has Actions for performing these tasks, whilst GitLab has pipelines, Codeberg uses Woodpecker CI and another popular framework is Jenkins.</p>
<p>I’m going to talk about GitHub Actions.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="github-actions" class="slide level2">
<h2>GitHub Actions</h2>
<ul>
<li>Actions are hooks that run under certain conditions e.g.&nbsp;<code>push</code> to <code>main</code> branch or <code>tag</code> beginning with <code>v</code>.</li>
<li>Useful for CI/CD.</li>
<li>Defined in <code>.github/workflows/*.yaml</code></li>
<li>Write your own <code>pre-commit.yaml</code> or…</li>
</ul>
<div class="fragment">
<ul>
<li>…use <a href="https://pre-commit.ci">pre-commit.ci</a></li>
</ul>
<aside class="notes">
<p>GitHub Actions are hooks in that they are processes that run when certain conditions are met for example a <code>push</code> to the <code>main</code> branch, or a commit has a <code>tag</code> applied.</p>
<p>As mentioned they are useful for running Continuous Integration and Delivery and in a Git repository they are defined in YAML files that live in the <code>.github/workflows/</code> directory.</p>
<p>You could write your own Action and save it in say <code>pre-commit.yaml</code> in this directory but there is an even easier service to use in the form of <code>pre-commit.ci</code> which is a CI extension to <code>pre-commit</code>.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="pre-commit.ci" class="slide level2">
<h2>pre-commit.ci</h2>
<ul>
<li>Supports GitHub but more to come in the future.</li>
<li>Zero configuration, just need <code>.pre-commit-config.yaml</code>.</li>
<li>Corrects &amp; commits issues automatically (e.g.&nbsp;<code>black</code>) without need for developer to reformat.</li>
<li>Automatically updates <code>.pre-commit-config.yaml</code> for you (e.g.&nbsp;new <code>rev</code>).</li>
<li>Free for open source repositories (paid for version for private/organisation repositories).</li>
</ul>
<aside class="notes">
<p>Pre-commit.ci is a continuous integration service for the <code>pre-commit</code> framework.</p>
<p>Currently it only supports GitHub but apparently support is in development for other platforms such as GitLab and so forth.</p>
<p>Its really easy to use, you don’t have to provide any specific configuration (although you can if you want to and I’ll get to that shortly).</p>
<p>If the configured <code>pre-commit</code> hooks make changes to your files such as <code>black</code> does <code>pre-commit.ci</code> will automatically fix the pull request.</p>
<p>It will also automatically keep you <code>.pre-commit-config.yaml</code> up-to-date when new revisions come out.</p>
<p>Its free for open source repositories, there are paid for options for private and organisation repositories.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="configuration-.pre-commit-config.yaml" class="slide level2">
<h2>Configuration (<code>.pre-commit-config.yaml</code>)</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb21-1"><a href="#cb21-1"></a></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">ci</span><span class="kw">:</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="at">  </span><span class="fu">autofix_prs</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="at">  </span><span class="fu">autofix_commit_msg</span><span class="kw">:</span><span class="at"> </span><span class="st">'[pre-commit.ci] Fixing issues with pre-commit'</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="at">  </span><span class="fu">autoupdate_schedule</span><span class="kw">:</span><span class="at"> weekly</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="at">  </span><span class="fu">autoupdate_commit_msg</span><span class="kw">:</span><span class="at"> </span><span class="st">'[pre-commit.ci] pre-commit automatically updated.'</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="at">  </span><span class="fu">skip</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">flake8</span><span class="kw">]</span><span class="co"> # Optionally list ids of hooks to skip on CI</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<aside class="notes">
<p>You can if you want configure <code>pre-commit.ci</code> with a <code>ci:</code> section in your <code>.pre-commit-config.yaml</code>, this example shows some explicit options to automatically fix pull requests and the message to add when doing so.</p>
<p>The update schedule is set to run <code>weekly</code> and as an example the <code>flake8</code> hook is set to be skipped.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pre-commit.ci-setup" class="slide level2">
<h2><code>pre-commit.ci</code> Setup</h2>
<ul>
<li>Sign-in with GitHub at <a href="https://pre-commit.ci">https://pre-commit.ci</a></li>
<li>Grant permission to your account.</li>
</ul>

<img data-src="assets/img/pre-commit-ci.png" class="r-stretch"><aside class="notes">
<p>To use <code>pre-commit.ci</code> just sign in with your GitHub credentials.</p>
<p>You can then follow the link to manage which repositories <code>pre-commit.ci</code> has access to on GitHub.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="manage-repos-for-pre-commit.ci" class="slide level2">
<h2>Manage Repos for <code>pre-commit.ci</code></h2>

<img data-src="assets/img/github-pre-commit-access.png" class="r-stretch"><p><a href="https://stackoverflow.com/collectives/articles/71270196/how-to-use-pre-commit-to-automatically-correct-commits-and-merge-requests-with-g">GitLab pre-commit</a></p>
<aside class="notes">
<p>You can provide <code>pre-commit.ci</code> access to all of your repositories or fine grained control to only specific repositories and that is all you need to do. Now when you push to <code>master</code> or <code>main</code> or make pull requests <code>pre-commit.ci</code> will run.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="add-pre-commit-badge" class="slide level2">
<h2>Add pre-commit badge</h2>

<img data-src="assets/img/pre-commit-button.png" class="r-stretch"><aside class="notes">
<p>Add a pre-commit badge to your repositories <code>README.md</code> and it will show if it has passed or failed the tests.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pre-commit-github-action" class="slide level2">
<h2>Pre-commit GitHub Action</h2>

<img data-src="assets/img/pre-commit-ci-pass.png" class="r-stretch"><aside class="notes">
<p>When you make a Pull Request on your repository the GitHub Actions run and you can see at the bottom here that the <code>pre-commit.ci</code> job is listed. If we click on details…</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pre-commit-pass" class="slide level2">
<h2>Pre-commit Pass</h2>

<img data-src="assets/img/pre-commit-ci-pass2.png" class="r-stretch"><p><a href="https://results.pre-commit.ci/run/github/168173540/1674062271.Tj4xDOxqRFu3CDIPhXkMJA">Pass</a></p>
<aside class="notes">
<p>We are taken to the job and can see exactly which checks were carried out and in this example we have <code>pylint</code> disabled so it shows as <code>Skipped</code> as were a few other steps but all the other checks passed. Sometimes jobs fail and</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pre-commit-fail" class="slide level2">
<h2>Pre-commit Fail</h2>

<img data-src="assets/img/pre-commit-ci-fail.png" class="r-stretch"><p><a href="https://results.pre-commit.ci/run/github/168173540/1674061180.-2Eo_dbfRAGrukip387Nhg">Fail</a></p>
<aside class="notes">
<p>Here you can see the <code>pre-commit</code> found trailing white spaces across a number of files and it went ahead and fixed them for us and automatically pushed them back to the branch for inclusion in the pull request.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li><span class="emoji" data-emoji="heavy_check_mark">✔️</span> <code>pre-commit</code> is useful for automating repetitive tasks.</li>
<li><span class="emoji" data-emoji="heavy_check_mark">✔️</span> Improves code quality by ensuring style guides are adhered to.</li>
<li><span class="emoji" data-emoji="heavy_check_mark">✔️</span> Automates running test suites and ensures they pass.</li>
<li><span class="emoji" data-emoji="heavy_check_mark">✔️</span> Integrates with CI/CD on GitHub and others.</li>
<li><span class="emoji" data-emoji="heavy_check_mark">✔️</span> Frees up developer time.</li>
</ul>
</section>
<section id="bonus---linting-with-ide" class="slide level2">
<h2>Bonus - Linting with IDE</h2>
<p>Popular IDEs have tools to run linting automatically on file save…</p>
<ul>
<li>Emacs : <a href="https://github.com/pythonic-emacs/blacken">blacken</a> / <a href="https://www.flycheck.org/en/latest/">Flycheck</a> / <a href="https://pylint.pycqa.org/en/latest/user_guide/installation/ide_integration/flymake-emacs.html">Pylint &amp; Flymake</a></li>
<li>VSCode : <a href="https://code.visualstudio.com/docs/python/linting">Python</a></li>
<li>PyCharm : <a href="https://plugins.jetbrains.com/plugin/10563-black-pycharm">black</a> / <a href="https://plugins.jetbrains.com/plugin/11086-mypy">Mypy</a> / <a href="https://plugins.jetbrains.com/plugin/11563-flake8-support">flake8</a></li>
<li>RStudio : <a href="https://lintr.r-lib.org/index.html">lintr</a></li>
</ul>
<aside class="notes">
<p>Many popular Integrated Development Environments support linting of code on the fly or on saving files, Emacs has <code>blacken</code> and <code>flycheck</code> modes, the later of which will run <code>flake8</code>.</p>
<p>VSCode has a Python module for linting.</p>
<p>PyCharm has plugins for <code>black</code>, <code>mypy</code> and <code>flake8</code></p>
<p>RStudio has support for the <code>lintr</code> package (as does Emacs).</p>
<p>Using these tools is sensible as it can highlight quickly and early on problems with your code. Applying <code>black</code> automatically also takes out some mental overhead in thinking about whether you are using the correct formatting whilst writing code allowing you to focus on the problem you are trying to solve.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>

<div class="footer footer-default">
<p><a href="https://ns-rse.github.io/pre-commit/#/title-slide"><strong>ns-rse.github.io/pre-commit/</strong></a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'speaker',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>